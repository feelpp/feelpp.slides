
[.columns]
== Generic Toolbox :: Coefficient Form PDEs 

[%notitle]
[.columns]
===  Coefficient Form PDEs 

[.column.x-small.left.decentlightbg]
--
Find stem:[u_i,i=1...,N]  such that
[latexmath.xx-small]
++++
\begin{aligned}
d_i \frac{\partial u_i}{\partial t} + \nabla \cdot \left( -c_i \nabla u_i - \alpha u_i + \gamma_i \right)& \\
+ \beta_i \cdot \nabla u_i + a u_i &= f \quad \text{ in } \Omega
\end{aligned}
++++

* Coefficients can depend on the unknowns stem:[u_j,j=1 \ldots N].
* Automatic differentiation built on top of {feelpp} expression handling
* Various schemes based on Newton or Picard 
//* Space-time adaptation(coming soon in `develop` branch)

video::P-jOk82f8Ps[youtube, options="autoplay,loop,modest",height=300]
--
[.column.small.is-two-thirds]
--
.Predator-Prey coupled model link:https://github.com/feelpp/feelpp/tree/develop/toolboxes/coefficientformpdes/cases/predator-prey[[Github]]
[source,json]
----
"Models": {
    "cfpdes":{ "equations":["equation1","equation2"] },
    "equation1":{
        "setup":{
            "unknown":{"basis":"Pch1","name":"prey","symbol":"u"},
            "coefficients":{
                "c":"1", // diffusion
                "a":"-( (1-equation1_u) - equation2_v/(equation1_u+thealpha) ):thealpha:equation1_u:equation2_v", // life and death
                "d":"1" // time derivative
            } } },
    "equation2":{
        "setup":{
            "unknown":{ "basis":"Pch1", "name":"predator", "symbol":"v" },
            "coefficients":{
                "c":"thedelta:thedelta", // diffusion
                "a":"-( (thebeta*equation1_u)/(equation1_u+thealpha) - thegamma ):thebeta:thealpha:thegamma:equation1_u", // life and death
                "d":"1"// time derivative
            } } } }
    ...
----


--

[.columns]
=== Cahn Hilliard

[.column]
--
--
[.column.xx-small]
--
.Phase separation modeling
[stem]
++++
\begin{aligned}
&\frac{\partial u}{\partial t}-\nabla \cdot M\left(\nabla\left(\frac{d f}{d u}-\lambda \nabla^{2} u\right)\right)&=0 \quad \text { in } \Omega \text {, }\\
&M\left(\nabla\left(\frac{d f}{d u}-\lambda \nabla^{2} u\right)\right)&=0 \text { on } \partial \Omega,\\
&M \lambda \nabla u \cdot n&=0 \quad \text { on } \partial \Omega .
\end{aligned}
++++

.Mixed Form
[stem]
++++
\begin{array}{cc}
\frac{\partial c}{\partial t}-\nabla \cdot M \nabla \mu=&0 \quad \text { in } \Omega, \\
\mu-\frac{d f}{d c}+\lambda \nabla^{2} c&=0 & \text { in } \Omega .
\end{array}
++++
--

[.columns]
=== Cahn Hilliard

[.column]
--
.2D
video::ZNke5e7ElR4[youtube, opts="autoplay,loop,modest",height=300]
.3D
video::ZNke5e7ElR4[youtube, opts="autoplay,loop,modest",height=300]
--
[.column.xx-small]
--
.Phase separation modeling
[source,json]
----
json here
----
--


//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
// 1st try : first column -> equations & picture, second column -> json
[%notitle]
[.columns]
=== SuperConductor
[.column.x-small.left.decentlightbg]
--
.Model equations
[latexmath.xx-small]
++++
\begin{aligned}
    -\frac{1}{\mu}\Delta a_\theta + \frac{1}{\mu r^2}a_\theta + \sigma \frac{\partial a_\theta}{\partial t} =0  &\text{ in } \Omega \\
    a_\theta = \frac{r}{2}\text{B}_\text{applied} &\text{ on } \partial\Omega
\end{aligned}
++++
.Non-Linear Part (e-j power law):
[latexmath.xx-small]
++++
    \sigma=\begin{cases}\frac{j_c}{e_c}\left(\frac{||-\partial a_\theta / \partial t||}{e_c}\right)^{(1-n)/n} &\text{in } \Omega_c\\
    0 &\text{in } \Omega\setminus\Omega_c \end{cases}
++++

// picture with plot
// image:Figures/feelpp/feelpp-example_superconduct.png[height=200] 

// picture without plot
image:Figures/feelpp/feelpp-example_supra.png[height=300]
--
[.column.small.is-two-thirds]
--
.Bulk Superconductor Model
[source,json]
----

"Models":{
    "cfpdes":{ "equations":"magnetic" },
    "magnetic":{"common":{"setup":{
        "unknown":{"basis":"Pch1","name":"Atheta","symbol":"Atheta"}
        }},
        "models":[{
            "name":"magnetic_Conductor",
            "materials":"Conductor",
            "setup":{"coefficients":{
                    "c":"x/mu:x:mu",
                    "a":"1/mu/x:mu:x",
                    "d":"materials_Conductor_sigma*x
                         :materials_Conductor_sigma:x"}}
        },{
            "name":"magnetic_Air",
            "materials":"Air",
            "setup":{"coefficients":{
                    "c":"x/mu:x:mu",
                    "a":"1/mu/x:mu:x"}}}
        ]}}
    ...
----
--
//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

[.columns]
=== SuperConductor

[.column]
--
.2D
video::ZNke5e7ElR4[youtube, opts="autoplay,loop,modest",height=300]
.3D
video::ZNke5e7ElR4[youtube, opts="autoplay,loop,modest",height=300]
--
[.column.xx-small]
--
.Phase separation modeling
[source,json]
----
json here
----
--
