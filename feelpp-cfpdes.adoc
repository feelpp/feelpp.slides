
[.columns]
== Generic Toolbox :: Coefficient Form PDEs 

[%notitle]
[.columns]
===  Coefficient Form PDEs 

[.column.x-small.left.decentlightbg]
--
Find stem:[u_i,i=1...,N]  such that
[latexmath.xx-small]
++++
\begin{aligned}
d_i \frac{\partial u_i}{\partial t} + \nabla \cdot \left( -c_i \nabla u_i - \alpha u_i + \gamma_i \right)& \\
+ \beta_i \cdot \nabla u_i + a u_i &= f \quad \text{ in } \Omega
\end{aligned}
++++

* Coefficients can depend on the unknowns stem:[u_j,j=1 \ldots N].
* Automatic differentiation built on top of {feelpp} expression handling
* Various schemes based on Newton or Picard 
//* Space-time adaptation(coming soon in `develop` branch)

video::P-jOk82f8Ps[youtube, options="autoplay,loop,modest",height=300]
--
[.column.small.is-two-thirds]
--
.Predator-Prey coupled model link:https://github.com/feelpp/feelpp/tree/develop/toolboxes/coefficientformpdes/cases/predator-prey[[Github]]
[source,json]
----
"Models": {
    "cfpdes":{ "equations":["equation1","equation2"] },
    "equation1":{
        "setup":{
            "unknown":{"basis":"Pch1","name":"prey","symbol":"u"},
            "coefficients":{
                "c":"1", // diffusion
                "a":"-( (1-equation1_u) - equation2_v/(equation1_u+thealpha) ):thealpha:equation1_u:equation2_v", // life and death
                "d":"1" // time derivative
            } } },
    "equation2":{
        "setup":{
            "unknown":{ "basis":"Pch1", "name":"predator", "symbol":"v" },
            "coefficients":{
                "c":"thedelta:thedelta", // diffusion
                "a":"-( (thebeta*equation1_u)/(equation1_u+thealpha) - thegamma ):thebeta:thealpha:thegamma:equation1_u", // life and death
                "d":"1"// time derivative
            } } } }
    ...
----


--

[.columns]
=== Cahn Hilliard

[.column]
--
.Cahn-Hilliard in L-Shape domain stem:[6e-3s]
image:Figures/feelpp/toolboxes/cfpdes/cahn-hilliard/ch-3d-t6e-3.png[image,width=600]
--
[.column.xx-small]
--
.Phase separation modeling
[stem]
++++
\begin{array}[rl]
\frac{\partial u}{\partial t}-\nabla \cdot M\left(\nabla\left(\frac{d f}{d u}-\lambda \nabla^{2} u\right)\right)&=0 \quad \text { in } \Omega \text {, }\\
M\left(\nabla\left(\frac{d f}{d u}-\lambda \nabla^{2} u\right)\right)&=0 \text { on } \partial \Omega,\\
M \lambda \nabla u \cdot n=0 \quad \text { on } \partial \Omega,\quad f(u) &= u^2 (u^2-1)
\end{array}
++++

.Mixed Form
[stem]
++++
\begin{array}{rl}
\frac{\partial c}{\partial t}-\nabla \cdot M \nabla \mu=&0 \quad \text { in } \Omega, \\
\mu-\frac{d f}{d u}+\lambda \nabla^{2} u&=0 & \text { in } \Omega .
\end{array}
++++
--

[.columns]
=== Cahn Hilliard

[.column]
--
.2D
video::ZNke5e7ElR4[youtube, opts="autoplay,loop,modest",height=300]
.3D
video::ZNke5e7ElR4[youtube, opts="autoplay,loop,modest",height=300]
--
[.column.x-small]
--
.Phase separation modeling
[source,json]
----
"Models":
{
    "cfpdes":{ "equations":["equation1","equation2"] },
    "equation1":{
        "setup":{
            "unknown":{"basis":"Pch1","name":"c","symbol":"c"},
            "coefficients":{
                "d": "1",
                "gamma": "{-equation2_grad_mu_0,-equation2_grad_mu_1,-equation2_grad_mu_2}"
    }}},
    "equation2":{
        "setup":{
            "unknown":{"basis":"Pch1","name":"mu","symbol":"mu"},
            "coefficients":{
                "gamma":"{lambda*equation1_grad_c_0,lambda*equation1_grad_c_1, lambda*equation1_grad_c_2}", 
                "a":"1",
                "f": "equation1_c*equation1_c*(equation1_c*equation1_c - 1)"
    } } }
}
----
--


[.columns]
=== Supra conductor

[.column]
--
images here
--
[.column.xx-small]
--
.Model equations
[stem]
++++
\begin{aligned}
&\frac{\partial u}{\partial t}-\nabla \cdot M\left(\nabla\left(\frac{d f}{d u}-\lambda \nabla^{2} u\right)\right)&=0 \quad \text { in } \Omega \text {, }\\
&M\left(\nabla\left(\frac{d f}{d u}-\lambda \nabla^{2} u\right)\right)&=0 \text { on } \partial \Omega,\\
&M \lambda \nabla u \cdot n&=0 \quad \text { on } \partial \Omega .
\end{aligned}
++++

.Mixed Form
[stem]
++++
\begin{array}{cc}
\frac{\partial c}{\partial t}-\nabla \cdot M \nabla \mu=&0 \quad \text { in } \Omega, \\
\mu-\frac{d f}{d c}+\lambda \nabla^{2} c&=0 & \text { in } \Omega .
\end{array}
++++
--

[.columns]
=== Supra Conductor

[.column]
--
.2D
video::ZNke5e7ElR4[youtube, opts="autoplay,loop,modest",height=300]
.3D
video::ZNke5e7ElR4[youtube, opts="autoplay,loop,modest",height=300]
--
[.column.xx-small]
--
.Phase separation modeling
[source,json]
----
json here
----
--
